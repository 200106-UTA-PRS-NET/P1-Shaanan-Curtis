CREATE DATABASE PIZZABOX;
USE PIZZABOX;
CREATE TABLE "USER"
(
	Username	CHAR(30)	NOT NULL UNIQUE,
    Pass		CHAR(30)	NOT NULL,
    FullName	CHAR(60)	NOT NULL,	
    SessionLive	TINYINT		NOT NULL, -- Session state
    CONSTRAINT	USER_PK		PRIMARY KEY(Username)
);
CREATE TABLE STORE
(
	StoreID		INT				NOT NULL UNIQUE IDENTITY(1,1),
    City		CHAR(255)		NOT NULL,
    "State"		CHAR(2)			NOT NULL,
    Zip			CHAR(10)		NOT NULL,
    CONSTRAINT 	Location 		UNIQUE (City, State),
    CONSTRAINT	STORE_PK		PRIMARY KEY(StoreID)
);
CREATE TABLE INVENTORY
(
	StoreID		INT				NOT NULL UNIQUE,
    Preset		SMALLINT		NOT NULL,
    "Custom"	SMALLINT		NOT NULL,
    CONSTRAINT	INV_PK			PRIMARY KEY(StoreID),
    CONSTRAINT	INV_STORE_FK	FOREIGN KEY(StoreID)
	REFERENCES	STORE(StoreID)
    ON UPDATE NO ACTION
    ON DELETE CASCADE
);
CREATE TABLE ORDERS 
(
  OrderID 		BIGINT	 		NOT NULL IDENTITY(1,1),
  StoreID 		INT		 		NOT NULL,
  Username 		CHAR(30) 		NOT NULL,
  CONSTRAINT	ORDERS_PK		PRIMARY KEY(OrderID),
  CONSTRAINT	ORDERS_STORE_FK	FOREIGN KEY(StoreID)
  REFERENCES    STORE(StoreID)
  ON UPDATE	CASCADE
  ON DELETE	NO ACTION,
  CONSTRAINT	ORDERS_USER_FK	FOREIGN KEY(Username)
  REFERENCES 	"USER"(Username)
  ON UPDATE CASCADE
  ON DELETE NO ACTION
);
CREATE TABLE ORDERTYPE 
(
  OrderID		BIGINT			 NOT NULL,
  Preset 		CHAR(50) 		 NOT NULL,
  "Custom" 		CHAR(50) 		 NOT NULL,
  Dt 			VARCHAR(50) 	 NOT NULL,
  Tm 			VARCHAR(50) 	 NOT NULL,
  Cost			DECIMAL(16,2)	 NOT NULL,
  CONSTRAINT	OT_PK			 PRIMARY KEY(OrderID),
  CONSTRAINT	OT_FK			 FOREIGN KEY(OrderID)
  REFERENCES	ORDERS(OrderID)
  ON UPDATE CASCADE
  ON DELETE CASCADE
);
INSERT INTO "USER"(Username,FullName,Pass,SessionLive)VALUES('ADMIN','Global Administrator','Password123',0);
INSERT INTO "STORE"(City,"State",Zip)VALUES('Arlington','TX','76001');
INSERT INTO "STORE"(City,"State",Zip)VALUES('Miami','FL','33101');
INSERT INTO "STORE"(City,"State",Zip)VALUES('Charlottesville','VA','22901');
INSERT INTO INVENTORY(StoreID,Preset,"Custom")VALUES(1,1000,1000);
INSERT INTO INVENTORY(StoreID,Preset,"Custom")VALUES(2,1000,1000);
INSERT INTO INVENTORY(StoreID,Preset,"Custom")VALUES(3,1000,1000);